@echo off
chcp 65001 > nul
setlocal

rem Файл: check_node_modules_exist.bat
rem Перевіряє наявність директорії node_modules у вказаній піддиректорії проекту.
rem Використання: call check_node_modules_exist.bat <шлях_до_директорії_проекту_відносно_поточної>
rem Повертає 0 при наявності node_modules, 1 якщо відсутня.

set "PROJECT_SUBDIR=%~1"

echo Перевіряю директорію: "%PROJECT_SUBDIR%"
echo Поточна директорія: "%CD%"
echo Шукаю: "%PROJECT_SUBDIR%\node_modules"

if "%PROJECT_SUBDIR%"=="" (
    echo.
    echo Помилка: Функція check_node_modules_exist.bat викликана без вказання директорії.
    exit /b 1
)

if not exist "%PROJECT_SUBDIR%" (
    echo.
    echo Помилка: Директорія "%PROJECT_SUBDIR%" не існує.
    echo Можливі директорії у поточній папці:
    dir /b /ad
    exit /b 1
)

if not exist "%PROJECT_SUBDIR%\node_modules" (
    echo.
    echo Помилка: Директорія "node_modules" не знайдена у "%PROJECT_SUBDIR%".
    echo Вміст директорії "%PROJECT_SUBDIR%":
    dir /b "%PROJECT_SUBDIR%"
    echo.
    echo Будь ласка, виконайте "npm install" у директорії "%PROJECT_SUBDIR%".
    exit /b 1
)

echo node_modules знайдено у "%PROJECT_SUBDIR%".
exit /b 0